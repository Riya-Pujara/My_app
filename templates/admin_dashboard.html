{% extends 'base.html' %} {% load static %} {% block navbar %}{% endblock %}
{%block footer %}{% endblock %} {% block extra_css %}
<link rel="stylesheet" href="{% static 'css/admin_dashboard.css' %}" />
{% endblock %} {% block content %}
<div class="admin-wrapper">
  <aside class="sidebar">
    <div class="sidebar-brand">
      <a href="{% url 'home' %}" class="logo">Career<span>Connect</span></a>
      <p class="admin-tag">ADMIN PORTAL</p>
    </div>
    <ul class="sidebar-nav">
      <li>
        <a href="{% url 'admin_dashboard' %}" class="active"
          ><i class="fas fa-chart-pie"></i> Overview</a
        >
      </li>
      <li>
        <a href="#"><i class="fas fa-users-cog"></i> Manage Users</a>
      </li>
      <li>
        <a href="#"><i class="fas fa-briefcase"></i> Job Moderation</a>
      </li>
      <li>
        <a href="#"><i class="fas fa-check-double"></i> Verifications</a>
      </li>
      <li>
        <a href="#"><i class="fas fa-exclamation-triangle"></i> Reports</a>
      </li>
      <li>
        <a href="#"><i class="fas fa-cogs"></i> Site Settings</a>
      </li>
    </ul>
    <div class="sidebar-footer">
      <a href="{% url 'logout' %}" class="logout-link"
        ><i class="fas fa-power-off"></i> System Logout</a
      >
    </div>
  </aside>

  <main class="main-content">
    <header class="top-header">
      <div class="user-greeting">
        <h1>Platform Control</h1>
        <p>Global System Administrator: <strong>{{ user.username }}</strong></p>
      </div>
      <div class="header-right">
        <div class="status-indicator">
          <span class="pulse-green"></span> System Online
        </div>
        <div class="user-avatar">
          <img
            src="https://ui-avatars.com/api/?name=Admin&background=00d2ff&color=0a192f"
            alt="Admin"
          />
        </div>
      </div>
    </header>

    <section class="stats-container">
      <div class="stat-card">
        <h3>Total Registered Users</h3>
        <p class="number">{{ stats.total_users|default:"0" }}</p>
        <span class="label"
          >Seekers: {{ stats.seekers_count }} | Employers: {{
          stats.employers_count }}</span
        >
      </div>
      <div class="stat-card">
        <h3>Active Job Postings</h3>
        <p class="number">{{ stats.active_jobs }}</p>
        <span class="label">+{{ stats.jobs_today }} new today</span>
      </div>
      <div class="stat-card glow-card">
        <h3>Pending Approvals</h3>
        <p class="number">{{ stats.pending_verifications }}</p>
        <span class="label text-cyan">Requires Attention</span>
      </div>
    </section>

    <section class="table-container">
      <div class="table-header">
        <h2>User Account Management</h2>
        <form method="GET" action="" class="search-box">
          <i class="fas fa-search"></i>
          <input
            type="text"
            name="search"
            placeholder="Search by name, email or ID..."
            value="{{ request.GET.search }}"
          />
        </form>
        <div class="filter-group">
          <select class="role-filter" onchange="location = this.value">
            <option value="?role=all">All Roles</option>
            <option value="?role=seeker">Job Seekers</option>
            <option value="?role=employer">Employers</option>
          </select>
        </div>
      </div>

      <div class="responsive-table">
        <table class="admin-table">
          <thead>
            <tr>
              <th>User ID</th>
              <th>Full Name / Email</th>
              <th>Account Type</th>
              <th>Status</th>
              <th>Joined Date</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for profile in profiles %}
            <tr>
              <td>#CC-{{ profile.user.id }}</td>
              <td>
                <div class="user-cell">
                  <div class="avatar-sm">
                    {{ profile.user.first_name|slice:":1" }}{{
                    profile.user.last_name|slice:":1" }}
                  </div>
                  <div>
                    <p class="name">{{ profile.user.get_full_name }}</p>
                    <p class="email">{{ profile.user.email }}</p>
                  </div>
                </div>
              </td>
              <td>
                <span
                  class="role-badge {% if profile.role == 'Seeker' %}seeker{% else %}employer{% endif %}"
                >
                  {{ profile.role }}
                </span>
              </td>
              <td>
                <span
                  class="status-badge {% if profile.user.is_active %}active{% else %}warning{% endif %}"
                >
                  {% if profile.user.is_active %}Active{% else %}Suspended{%
                  endif %}
                </span>
              </td>
              <td>{{ profile.user.date_joined|date:"M d, Y" }}</td>
              <td class="action-btns">
                <button
                  class="btn-action view"
                  onclick="openProfile('{{ profile.user.get_full_name }}', '{{ profile.role }}', '{{ profile.user.email }}')"
                >
                  <i class="fas fa-eye"></i>
                </button>
                <form
                  action="{% url 'suspend_user' profile.user.id %}"
                  method="POST"
                  style="display: inline"
                >
                  {% csrf_token %}
                  <button type="submit" class="btn-action suspend">
                    <i class="fas fa-user-slash"></i>
                  </button>
                </form>
              </td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="6" style="text-align: center">
                No users found matching criteria.
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <div class="modal-overlay" id="profileModal">
    <div class="modal-box">
      <div class="modal-header">
        <h3>Account Inspection</h3>
        <button class="close-modal" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="profile-main">
          <div class="avatar-large" id="modalInitial">U</div>
          <h2 id="modalName">User Name</h2>
          <p id="modalRole" class="text-cyan">Account Role</p>
        </div>
        <div class="profile-details">
          <div class="detail-item">
            <span>Email:</span>
            <p id="modalEmail">user@example.com</p>
          </div>
          <div class="detail-item">
            <span>Status:</span>
            <p class="text-success">Verified Account</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-navy" onclick="closeModal()">Close Window</button>
        <button class="btn-cyan">Update Permissions</button>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block extra_js %}
<script>
  const modal = document.getElementById("profileModal");
  function openProfile(name, role, email) {
    document.getElementById("modalName").innerText = name;
    document.getElementById("modalRole").innerText = role;
    document.getElementById("modalEmail").innerText = email;
    document.getElementById("modalInitial").innerText = name.charAt(0);
    modal.style.display = "flex";
  }
  function closeModal() {
    modal.style.display = "none";
  }
</script>
{% endblock %}
